name: ðŸš€ Deploy Hugo site

on:
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: âœ… Checkout code
        uses: actions/checkout@v4

      - name: ðŸ› ï¸ Install Hugo CLI
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: '0.124.1'
          extended: true

      - name: ðŸ”¨ Build Hugo site
        run: hugo --minify

      - name: ðŸ“‚ Check public/ directory
        run: ls -lah public || echo "âš ï¸ public/ prieÄinok neexistuje"

      - name: ðŸ§ª Over server prÃ­stup
        uses: appleboy/ssh-action@v0.1.10
        with:
          host: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 28144
          script: |
            echo ">> Obsah ~/tomashujcak.sk/web:"
            ls -lah ~/tomashujcak.sk/web || echo "âŒ CieÄ¾ neexistuje"

      - name: ðŸš€ Deploy cez rsync
        uses: appleboy/ssh-action@v0.1.10
        with:
          host: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 28144
          script: |
            echo ">> Deployujem..."
            rsync -avz --delete public/ ~/tomashujcak.sk/web/
